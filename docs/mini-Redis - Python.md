# mini-Redis: Упрощенная реализация Redis на Python с использованием Gevent
Этот проект представляет собой упрощенную реализацию хранилища данных типа ключ-значение Redis, написанную на Python с использованием библиотеки Gevent для обеспечения параллельности. Проект разработан как учебное пособие для понимания внутреннего устройства Redis и принципов создания параллельных сетевых приложений.

## Возможности
*   **Основные команды Redis:** Реализованы базовые команды Redis, такие как `GET`, `SET`, `DELETE`, `FLUSH`, `MGET` и `MSET`.
*   **Протокол RESP:** Выполняется разбор и формирование ответов с использованием протокола сериализации Redis (RESP).
*   **Параллельность Gevent:** Обработка множества клиентских соединений одновременно с использованием "зеленых потоков" Gevent.
*   **Базовая обработка ошибок:** Возвращаются соответствующие сообщения об ошибках для неверных команд или данных.

## Требования
* Python 3.7+
* Библиотека ```gevent```
* Среда разработки PyCharm

## Установка
1.  Скачайте файлы технологии и перенесите их в среду разработки.

2.  Создайте виртуальное окружение:
    ```
    python3 -m venv venv
    source venv/bin/activate  # Linux/macOS
    venv\Scripts\activate  # Windows
    ```

3.  Установите зависимости:
    ```
    pip install gevent
    ```

## Использование

1.  Запустите сервер:

2.  Подключитесь к серверу с помощью предоставленного клиента:

3. Подключитель к клиентской части с помощью командной строки и протокола telnet.
```
telnet ip-адреас порт
```

Все подробности указаны в [техническом руководстве]().

## Архитектура
Реализация mini-Redis состоит из двух основных компонентов:
*   **Сервер (`server.py`):** Обрабатывает входящие клиентские соединения, разбирает запросы, выполняет команды и отправляет ответы. Использует Gevent для параллельной обработки соединений.
*   **Клиент (`client.py`):** Устанавливает соединение с сервером, отправляет команды и получает ответы.

Подробности смотрите в []()

## Поддерживаемые команды
Список поддерживаемых команд и их использование смотрите в []()

# Архитектура mini-Redis
Архитектура mini-Redis является клиент-серверной и использует Gevent для асинхронного сетевого ввода-вывода.

**Серверная часть (`server.py`):**
1.  **Обработка соединений:** Класс `Server` использует `gevent.server.StreamServer` для прослушивания входящих TCP-соединений на указанном хосте и порту. Для каждого нового соединения вызывается метод `connection_handler`.
2.  **Параллельность:** `gevent.pool.Pool` ограничивает количество одновременных клиентских соединений.
3.  **Обработка запросов:** Метод `connection_handler` использует класс `ProtocolHandler` для:
    *   Чтения и разбора клиентских запросов с использованием протокола RESP.
    *   Направления команд соответствующим методам-обработчикам.
    *   Записи ответов обратно клиенту в формате RESP.
4.  **Хранение данных:** Сервер хранит данные в словаре Python `self._kv`.
5.  **Выполнение команд:** Метод `get_response` проверяет и выполняет команды, вызывая соответствующие методы (`get`, `set`, `delete`, `flush`, `mget`, `mset`) на экземпляре класса `Server`.

**Клиентская часть (`client.py`):**
1.  **Соединение:** Класс `Client` устанавливает TCP-соединение с сервером.
2.  **Кодирование запросов:** Метод `encode_resp_array` кодирует команды и аргументы в формат RESP.
3.  **Отправка запросов:** Команды отправляются на сервер через сокет.
4.  **Чтение ответов:** Метод `read_response` читает и разбирает RESP-ответ от сервера.
5.  **Обработка ошибок:** Клиент вызывает исключение `CommandError`, если сервер возвращает сообщение об ошибке.

# Протокол сериализации Redis (RESP)
Эта реализация mini-Redis использует подмножество протокола сериализации Redis (RESP) для обмена данными между клиентом и сервером. RESP - это текстовый протокол, который легко разбирается.

Поддерживаются следующие типы данных RESP:
*   **Простые строки:** Начинаются с `+`, за которым следует строка и `\r\n`. Пример: `+OK\r\n`
*   **Ошибки:** Начинаются с `-`, за которым следует сообщение об ошибке и `\r\n`. Пример: `-Error message\r\n`
*   **Целые числа:** Начинаются с `:`, за которым следует целое число и `\r\n`. Пример: `:1000\r\n`
*   **Строки (Bulk Strings):** Начинаются с `$`, за которым следует длина строки, `\r\n`, данные строки и `\r\n`. Нулевая строка представляется как `$-1\r\n`. Пример: `$11\r\nhello world\r\n`
*   **Массивы:** Начинаются с `*`, за которым следует количество элементов в массиве и `\r\n`, затем каждый элемент в формате RESP. Пример: `*2\r\n$5\r\nhello\r\n$5\r\nworld\r\n`
*   **Словари:** Начинаются с `%`, за которым следует количество пар ключ-значение в словаре и `\r\n`, затем каждый ключ и значение в формате RESP. Пример: `%2\r\n$4\r\nname\r\n$5\r\nbob\r\n$3\r\nage\r\n$2\r\n25\r\n`

# Поддерживаемые команды Redis
Эта реализация mini-Redis поддерживает следующие команды Redis:

*   **`GET <ключ>`:** Возвращает значение, связанное с указанным ключом. Возвращает `None`, если ключ не существует.
*   **`SET <ключ> <значение>`:** Устанавливает значение, связанное с указанным ключом. Возвращает `1` при успехе.
*   **`DELETE <ключ>`:** Удаляет пару ключ-значение, связанную с указанным ключом. Возвращает `1`, если ключ был удален, `0`, если ключ не существовал.
*   **`FLUSH`:** Удаляет все пары ключ-значение. Возвращает количество удаленных ключей.
*   **`MGET <ключ1> <ключ2> ...`:** Возвращает список значений, связанных с указанными ключами. Возвращает `None` для ключей, которые не существуют.
*   **`MSET <ключ1> <значение1> <ключ2> <значение2> ...`:** Устанавливает значения для нескольких ключей. Требуется четное количество аргументов. Возвращает количество установленных пар ключ-значение.

**Пример использования (с использованием клиента):**
